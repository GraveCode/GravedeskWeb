## Synopsis

Gravedesk is a web and email based helpdesk ticket tracker. This project - GravedeskWeb - is a generated static HTML5 website designed to be hosted on an ordinary web-server. The backend powered by node.js - GravedeskIO - is also required.

We needed a simple to use ticket system for our IT Support department, that would work well with the many help requests received to our support email address. This is the web-based half that allows the management, editing, replying and closing of tickets by the IT helpdesk; as well as allow end-users to view, update and add new tickets via their browser.

## Features

- hosted as a static HTML website - no webserver scripting required.
- uses socket.io to communicate with the backend node server, a GravedeskIO instance, to provide realtime updates as tickets are added and updated
- individual tickets have a friendly text-message style view
- uses google OAUTH2 authentication for federated account management, including support for restricting to a single google apps domain
- uses context.io for timely retrieval of email messages


## Requirements

- webserver to host the static HTML with forward proxy http 1.1 support, tested on nginx
- GravedeskIO server already running
- a computer to run the node.js static site-generator (wintersmith) to create the final customised HTML

## Installation

### Sample nginx config


	server {
		listen   80; ## listen for ipv4; this line is default and implied
		listen [::]:80;
		server_name itsupport.example.com itsupport;
		root /srv/web/itsupport/public_html;
		access_log /var/log/nginx/itsupport.log;
	
		# pass the request to the GravedeskIO node.js server
		location /node {
			proxy_set_header X-Real-IP $remote_addr;
			proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
			proxy_set_header Host $http_host;
			proxy_set_header X-NginX-Proxy true;
			proxy_http_version 1.1;
			proxy_set_header Upgrade $http_upgrade;
			proxy_set_header Connection "upgrade";
			proxy_pass http://127.0.0.1:3000/node;
			proxy_redirect off;
		}
	}

In this example, the site generated by GravedeskWeb will be stored in `/srv/web/itsupport/public_html`

HTTP 1.1 proxy support is added to fully support the socket.io websocket connections to the backend, running on the same server in this instance. The backend server does not need to be accessible to the internet, as all connections to it will be proxied by nginx.

### Static site-generator setup

- install node.js
- once done, run `npm install -g wintersmith` to install wintersmith
- run `npm install -g coffee-script`
- download a copy of GravedeskWeb (this software);
- one way is to use git to clone this repo; `git clone https://github.com/GraveCode/GravedeskWeb.git`
- enter the GravedeskWeb folder
- run `npm install` to install the GravedeskWeb specific modules
- copy `config-example.json` to `config.json`
- edit the URL and name to suit your site
- (optional) add an image at /images/logo.png for a logo
- run `wintersmith build`
- This should create a `build` folder. Copy the contents of `build` to your webserver via sftp etc.

### Regenerate site

- If you make changes to the config.json, pull down a new version of GravedeskWeb, or otherwise alter the static source files, re-run `wintersmith build` and copy the new files up to your webserver.


## License

A short snippet describing the license (MIT, Apache, etc.)